<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>COVID-19 Prediction</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex align-items-center justify-content-center vh-100">

<div class="card shadow-lg" style="max-width: 400px; width: 100%;">
  <div class="card-header bg-primary text-white text-center">
    <h4>COVID-19 Predictor</h4>
  </div>
  <div class="card-body">
    <form id="predictForm">
      <div class="mb-3">
        <label for="age" class="form-label">Age</label>
        <input id="age" type="number" class="form-control" value="35">
      </div>
      <div class="mb-3">
        <label for="sex" class="form-label">Sex</label>
        <select id="sex" class="form-select">
          <option value="1">Male</option>
          <option value="0">Female</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="cough" class="form-label">Cough</label>
        <select id="cough" class="form-select">
          <option value="1">Yes</option>
          <option value="0">No</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="fever" class="form-label">Fever</label>
        <select id="fever" class="form-select">
          <option value="1">Yes</option>
          <option value="0">No</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="fatigue" class="form-label">Fatigue</label>
        <select id="fatigue" class="form-select">
          <option value="1">Yes</option>
          <option value="0">No</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="chest_pain" class="form-label">Chest Pain</label>
        <select id="chest_pain" class="form-select">
          <option value="1">Yes</option>
          <option value="0">No</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="difficulty_breathing_or_dyspnea" class="form-label">Difficulty Breathing / Dyspnea</label>
        <select id="difficulty_breathing_or_dyspnea" class="form-select">
          <option value="1">Yes</option>
          <option value="0">No</option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary w-100">Predict</button>
    </form>
    <div class="mt-3"> <h6>Result:</h6> <div id="out" class="alert alert-secondary" role="alert"> Click on Predict...
    </div>
  </div>
</div>

<script>
document.getElementById("predictForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const payload = {
    age: Number(document.getElementById("age").value),
    sex: Number(document.getElementById("sex").value),
    cough: Number(document.getElementById("cough").value),
    fever: Number(document.getElementById("fever").value),
    fatigue: Number(document.getElementById("fatigue").value),
    chest_pain: Number(document.getElementById("chest_pain").value),
    difficulty_breathing_or_dyspnea: Number(document.getElementById("difficulty_breathing_or_dyspnea").value)
  };
  try {
    const resp = await fetch("http://127.0.0.1:21512/predict", {   // <-- use your actual port here
      method: "POST",
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });

    if (!resp.ok) {
      throw new Error("Prediction request failed");
    }

    const j = await resp.json();
    const result = j[0];   // because plumber sends an array
    const probPercent = (result.probability * 100).toFixed(1);

    // update user-friendly output
    document.getElementById("out").className = 
      result.prediction === "POSITIVE" ? "alert alert-danger" : "alert alert-success";

    document.getElementById("out").textContent = 
      `Prediction: ${result.prediction} (Probability: ${probPercent}%)`;

  } catch (err) {
    document.getElementById("out").className = "alert alert-warning";
    document.getElementById("out").textContent = "Error: " + err.message;
  }
});
</script>

</body>
</html>
